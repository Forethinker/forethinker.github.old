<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Forethinker</title>
    <meta name="description" content="">
    <meta name="author" content="forethinker">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://www.4thinker.com/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="https://www.4thinker.com/theme/local.css" rel="stylesheet">
    <link href="https://www.4thinker.com/theme/pygments.css" rel="stylesheet">
    <link href="https://www.4thinker.com/theme/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'>
</head>

<!-- Using MathJax, with the delimiters $ -->
<!-- Conflict with pygments for the .mo and .mi -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        "HTML-CSS": {
            styles: {
                ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
            },
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],processEscapes: true}
            });
            MathJax.Hub.Register.StartupHook("HTML-CSS Jax Ready",function () {
                var VARIANT = MathJax.OutputJax["HTML-CSS"].FONTDATA.VARIANT;
                VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
                VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
                VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
                VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
                });
                MathJax.Hub.Register.StartupHook("SVG Jax Ready",function () {
                    var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;
                    VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
                    VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
                    VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
                    VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
                    });
                </script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid" styel="height: 0px;">
    	<a href="https://www.4thinker.com" class="brand">Forethinker</a>


        <ul class="nav nav-pills pull-right" style="height: 16px; margin-top: 9px;">
 
               <form action="http://google.com/search" method="get"> 
                   <fieldset role="search"> 
                       <input type="hidden" name="q" value="site:https://www.4thinker.com" />
                       <input class="search" type="text" name="q" results="0" value="search" onfocus="if (this.value=='search') this.value = ''" type="text" type="text" maxlength="80" size="28"/> 
                   </fieldset>
               </form>
        </ul>

        <ul class="nav nav-pills pull-right" style="margin-top: 7px;">
            <li >
              <a href="https://www.4thinker.com/category/algs.html ">algs</a>
            <li >
              <a href="https://www.4thinker.com/category/cs.html ">cs</a>
            <li >
              <a href="https://www.4thinker.com/category/dev.html ">dev</a>
            <li >
              <a href="https://www.4thinker.com/category/hack.html ">hack</a>
            <li >
              <a href="https://www.4thinker.com/category/life.html ">life</a>
            <li >
              <a href="https://www.4thinker.com/category/sysadmin.html ">sysadmin</a>
            <li >
              <a href="https://www.4thinker.com/category/web.html ">web</a>

        </ul>

    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span12">
        

        

    <div class='row-fluid''>
        <div class="article-title span12">
            <a href="https://www.4thinker.com/jquery-ajax-notes.html"><h1>AJAX notes</h1></a>
        </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<div class="article-sidebar">

<span>July 29, 2013 </span>

<span>
[ <a href="https://www.4thinker.com/category/web.html">web</a> ]
</span>

<span>
 
<a href="https://www.4thinker.com/tag/javascript.html">#javascript</a></span>

  <span>Read in 9 min.</span>

    <span id="post-share-links">
        <a href="http://twitter.com/home?status=AJAX%20notes%20 https%3A//www.4thinker.com/jquery-ajax-notes.html" target="_blank" title="Share on Twitter"><i class="icon-large icon-twitter-sign"></i></a> 
        <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=https%3A//www.4thinker.com/jquery-ajax-notes.html&p[images][0]=&p[title]=AJAX%20notes%20&p[summary]=%3Cp%3E%3Ca%20href%3D%22http%3A//mbsy.co/7sh6q%22%3EjQuery%20-%20The%20Return%20Flight%3C/a%3E%20by%20Gregg%20Pollak%20%40%20%3Ca%20href%3D%22codeschool.com%22%3Ecodeschool.com%3C/a%3E%3C/p%3E%0A%3Ch2%3EBasic%3C/h2%3E%0A%3Cp%3EAsynchronous%20Javascript%20And%20XML%20-%20updates%20the%20client%20page%20by%20interacting%20the%20server%20without%20a%20refresh.%20jQuery%20downloads%20everything%20beforehand%20and%20manipulates%20CSS%20for%20visual%20effects%2C%20AJAX%20makes%20seamless%20interaction%20with%20the%20user%20by%20downloading%20contents%20on%20a%20need-basis.%20%3C/p%3E%0A%3Cp%3E%3Ccode%3E%24.ajax%28URL%2C%20options%29%3C/code%3E%20-%20first%20argument%20specifies%20the%20URL%20to%20request%20data%20from%20the%20server%2C%20the%20second%20argument%20is%20a%20javascript%20object%20with%20properties%20mentioned%20below.%20It%20requires%20%3Ccode%3Esuccess%3C/code%3E%20property.%3C/p%3E%0A%3Cp%3EEvent%20Delegation%2C%20or%20specifying%20%3Ccode%3E%26lt%3Btarget%26gt%3B%3C/code%3E%20argument%20for%20%3Ccode%3Eon%28%29%3C/code%3E%2C%20is%20often%20necessary%20for%20successful%20AJAX%20requests%2C%20because%20the%20target%20element%20might%20not%20have%20existed%20%E2%80%A6%3C/p%3E" target="_blank" title="Share on Facebook"><i class="icon-large icon-facebook-sign"></i></a> 
        <a href="https://plus.google.com/share?url=https%3A//www.4thinker.com/jquery-ajax-notes.html" target="_blank" title="Share on Google Plus"><i class="icon-large icon-google-plus-sign"></i></a> 
        <!--<a href="" target="_blank" title="Share on Linkedin"><i class="icon-large icon-linkedin-alt"></i></a>-->
        <a href="mailto:?subject=AJAX%20notes%20&body=https%3A//www.4thinker.com/jquery-ajax-notes.html" target="_blank" title="Share via Email"><i class="icon-large icon-envelope-sign"></i></a>
    </span>

</div>      </div>
      <div class="article-content span10">
	<p><a href="http://mbsy.co/7sh6q">jQuery - The Return Flight</a> by Gregg Pollak @ <a href="codeschool.com">codeschool.com</a></p>
<h2>Basic</h2>
<p>Asynchronous Javascript And XML - updates the client page by interacting the server without a refresh. jQuery downloads everything beforehand and manipulates CSS for visual effects, AJAX makes seamless interaction with the user by downloading contents on a need-basis. </p>
<p><code>$.ajax(URL, options)</code> - first argument specifies the URL to request data from the server, the second argument is a javascript object with properties mentioned below. It requires <code>success</code> property.</p>
<p>Event Delegation, or specifying <code>&lt;target&gt;</code> argument for <code>on()</code>, is often necessary for successful AJAX requests, because the target element might not have existed when the page was initially loaded.</p>
<h2>Object-Oriented-Programming</h2>
<h4>JavaScript object ~== struct</h4>
<ul>
<li>javascript variable may contain an object</li>
<li>javascript object may contain methods. The key is the name of the method and the value is the function defintion. If these functions are refactored or refer other methods in the current object, they must be referred with <code>this.</code> </li>
<li>javascript object may be defined outside of <code>$(document).ready()</code> function and can still be called. In javascript, the scope is not limited to the parenthesis. So there is not need to redefined it.</li>
</ul>
<h4>JavaScript Function ~== class</h4>
<ul>
<li>There is no way to reuse the method defintions with a different variable. <strong>Function</strong>, provides a real Object-Oriented-Data Structure. It is defined with <code>function Name(parameter){}</code>. It's instance is created with <code>var name = new Name('parameter')</code> syntax.</li>
<li>if the function is public, it is defined with <code>this.</code> prefix.</li>
</ul>
<h4>This and $(this)</h4>
<p>Inisde AJAX callbacks, <code>this</code> is set to the AJAX setting, in order to change it, <code>context</code> property is used. <code>this</code> is used to refer the current object, so it is typically used to use the members of that object. <code>this</code> is not to be confused with <code>$(this)</code>, which referes to a jQuery object for DOM. When there are multiple matches for a given specifier, then the selector will returned in a array of objects. This array can be iterated with <code>each(function)</code>, which takes in a function to exexcute for each object. It is possible that <code>this</code> maybe referring to a DOM objects(s), for example, when using jQuery plugin on a jQuery object. </p>
<h2>parameters</h2>
<ul>
<li><code>response</code>: the contents returned by the specified URL</li>
<li><code>errorType</code>, <code>errorMessage</code></li>
</ul>
<h2>Options</h2>
<p>Options here means the javascript object that gets passed into <code>$ajax()</code>:
- <code>success</code>: a function to execute when the request was returned successfully
- <code>error</code>: a function to execute when the request has failed
- <code>data</code>: a javascript object with string as the key to be appended to the request. (e.g. e.html?q=searchterm). The value may be retrived from HTML's <code>data-name</code> attribute with jQuery's <code>data()</code> function. Or in the case with 'POST' type request, it can be set to <code>$('form').serialize()</code> simplify the syntax. <code>this</code> variable within <code>data</code> property is not affected by <code>context</code>.
- <code>timeout</code>: time in ms to determined whether the request has failed. The default value is different for different browsers.
- <code>beforeSend</code>: a function to execute before the request is made, typeically used to show the loading status.
- <code>complete</code>: a function to execute after the response was returned, regardless of its success, typically used to stop the loading status.
- <code>context</code>: a variable that sets the value of <code>this</code> inside of the AJAX callback. 
- <code>type</code>: the value is 'GET' by default, but it can be 'POST' to send the data. <code>event.preventDefault</code> is necessary is that case.
- dataType: a type to parse the data as. (e.g 'json')
- contentType: a type of data to ask the server to respond with. (e.g. 'application/json')</p>
<h2>JSON</h2>
<ul>
<li>a JSON object always has string as the type for both key and value, while javascript object has a variable as a key.</li>
<li>a JSON object is converted to a Javascript object when 'json' is specified as the <code>dataType</code>. The properties of the object can be accessed with <code>result.propertyName</code>. These varaibles can be inserted in a jQuery object (with append(), prepend(), etc) and then be appended to DOM.</li>
<li>When AJAX request returns an array of jQuery objects, they can be iterated with a jQuery Utility method:</li>
</ul>
<h4>jQuery Utility</h4>
<div class="highlight"><pre><span></span>$.each(result, function(index, object)) {
}

var newArray = $.map(result, function(item, index)) {
    return item;
});
</pre></div>


<p><code>$.each</code> does not modify the array, while <code>$.map</code> does. <code>html()</code> jQuery function can handle an array of jQuery nodes by joining them before attaching it to the DOM, but it is recommended to execute <code>detach()</code> before and <code>appendTo('parentNode')</code> so that the DOM does not get updated while it is displayed, but rather removed, modifed, then inserted back in. This is more efficient. </p>
<p><code>$.extend(target[, object1][, objectn])</code> is used to compress arguments or allow a varying number of arugments for the function making the function call.</p>
<div class="highlight"><pre><span></span><span class="o">|</span> <span class="nt">Call</span>                                 <span class="o">|</span> <span class="nt">Result</span>                <span class="o">|</span>
<span class="o">|</span> <span class="o">$</span><span class="p">.</span><span class="nc">extend</span><span class="o">(</span><span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">3</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">price</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span><span class="o">);</span> <span class="o">|</span> <span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">price</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">|</span> <span class="o">$</span><span class="p">.</span><span class="nc">extend</span><span class="o">(</span><span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">3</span> <span class="p">}</span><span class="o">,</span> <span class="p">{}</span><span class="o">);</span>           <span class="o">|</span> <span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">3</span> <span class="p">}</span>           <span class="o">|</span>
<span class="o">|</span> <span class="o">$</span><span class="p">.</span><span class="nc">extend</span><span class="o">(</span><span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">3</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span><span class="o">);</span>  <span class="o">|</span> <span class="p">{</span> <span class="n">days</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>           <span class="o">|</span>

<span class="nt">var</span> <span class="nt">settings</span> <span class="o">=</span> <span class="o">$</span><span class="p">.</span><span class="nc">extend</span><span class="o">(</span><span class="nt">defaultObject</span><span class="o">,</span> <span class="nt">options</span><span class="o">)</span>
</pre></div>


<p>Often <code>$(this)</code> and <code>data()</code> are included in <code>defaultObject</code>.</p>
<h2>Other design choice</h2>
<p>When displaying the results of the AJAX response, hiding an element, placing the result, and then fading in creates a good effect:</p>
<div class="highlight"><pre><span></span>$(&#39;#table&#39;).hide().html(result).fadeIn()
</pre></div>


<h2>Form</h2>
<p>Using <code>attr('action')</code> of a form element to specify a jQuery object can make AJAX request to be more genearl and be flexible:</p>
<div class="highlight"><pre><span></span>$.ajax($(&#39;form&#39;).attr(&#39;action&#39;), {...});
</pre></div>


<h2>Shorthand $.ajax() request</h2>
<div class="highlight"><pre><span></span>`$.get(url, function(result){ ... })`: a simplifed version of `$.ajax()`
`$.getJSON(url, function(result){ ... })`: a simplifed version of `$.ajax()` JSON Get request.
</pre></div>


<h2>examples</h2>
<div class="highlight"><pre><span></span>$(document).ready(function() {
  function showPhotos() {
    $(this).find(&#39;span&#39;).slideToggle();
  }
  $(&#39;.photos&#39;).on(&#39;mouseenter&#39;, &#39;li&#39;, showPhotos).on(&#39;mouseleave&#39;, &#39;li&#39;, showPhotos);
  var el = $(&quot;#tour&quot;);
  el.on(&quot;click&quot;, &quot;button&quot;, function() {
    $.ajax(&#39;/photos.html&#39;, {
      data: {location: el.data(&#39;location&#39;)},
      success: function(response) {
        $(&#39;.photos&#39;).html(response).fadeIn();
      },
      error: function() {
        $(&#39;.photos&#39;).html(&#39;<span class="nt">&lt;li&gt;</span>There was a problem fetching the latest photos. Please try again.<span class="nt">&lt;/li&gt;</span>&#39;);
      },
      timeout: 3000,
      beforeSend: function() {
        $(&#39;#tour&#39;).addClass(&#39;is-fetching&#39;);
      },
      complete: function() {
        $(&#39;#tour&#39;).removeClass(&#39;is-fetching&#39;);
      }
    });
  });
});
</pre></div>


<ul>
<li>refactors <code>el</code> to be used within <code>$.ajax()</code></li>
<li><code>data</code> extracts data attribute form HTML</li>
<li><code>beforeSend</code> and <code>complete</code> to do preprocessing and postprocessing</li>
<li><code>timeout</code> to delay the request</li>
<li>event delegation on <code>.photos li</code> </li>
</ul>
<hr>
<div class="highlight"><pre><span></span>var tour = {
  init: function() {
    $(&quot;#tour&quot;).on(&quot;click&quot;, &quot;button&quot;, this.fetchPhotos);
  },
  fetchPhotos:  function () {
      $.ajax(&#39;/photos.html&#39;, {
        data: {location: $(&quot;#tour&quot;).data(&#39;location&#39;)},
        success: function(response) {
          $(&#39;.photos&#39;).html(response).fadeIn();
        },
        error: function() {
          $(&#39;.photos&#39;).html(&#39;<span class="nt">&lt;li&gt;</span>There was a problem fetching the latest photos. Please try again.<span class="nt">&lt;/li&gt;</span>&#39;);
        },
        timeout: 3000,
        beforeSend: function() {
          $(&#39;#tour&#39;).addClass(&#39;is-fetching&#39;);
        },
        complete: function() {
          $(&#39;#tour&#39;).removeClass(&#39;is-fetching&#39;);
        }
      });
  }
};

$(document).ready(function() { 
  tour.init();
});
</pre></div>


<ul>
<li>AJAX request refactored into a javascript. </li>
<li>callback function refactored a javascript object. </li>
</ul>
<hr>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Tour</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">tour</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">fetchPhotos</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;/photos.html&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="nx">location</span>: <span class="kt">tour.el.data</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">)},</span>
      <span class="nx">context</span>: <span class="kt">tour</span><span class="p">,</span>
      <span class="nx">success</span>: <span class="kt">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.photos&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">fadeIn</span><span class="p">();</span>
      <span class="p">},</span>
      <span class="nx">error</span>: <span class="kt">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.photos&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&lt;li&gt;There was a problem fetching the latest photos. Please try again.&lt;/li&gt;&#39;</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="nx">timeout</span>: <span class="kt">3000</span><span class="p">,</span>
      <span class="nx">beforeSend</span>: <span class="kt">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;is-fetching&#39;</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="nx">complete</span>: <span class="kt">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;is-fetching&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;button&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">fetchPhotos</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
  <span class="kd">var</span> <span class="nx">paris</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tour</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#paris&#39;</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">london</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tour</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#london&#39;</span><span class="p">));</span>
<span class="p">});</span>
</pre></div>


<ul>
<li>The function(fetchInfo) needs to be defined before it is bound by <code>on</code> callback.</li>
<li><code>context</code> is used to set <code>this</code> within the ajax callback to refer to a DOM element. </li>
<li><code>data</code> is not affect by by <code>context</code>, so it needs use the alias for <code>this</code> directly. </li>
</ul>
<hr>
<div class="highlight"><pre><span></span>$(document).ready(function() {
  $(&#39;form&#39;).on(&#39;submit&#39;, function(event) {
    event.preventDefault();
    var form = $(this);
    $.ajax(&#39;/book&#39;, {
      dataType: &#39;json&#39;,
      type: form.attr(&#39;method&#39;),
      data: form.serialize(),
      success: function(r) {
        $(&#39;.tour&#39;).html(r.description+&#39; &#39;+r.price+&#39; &#39;+r.nights+&#39; &#39;+r.confirmation);
      }
    });
  });
});
</pre></div>


<ul>
<li>refactors <code>form</code> variable </li>
<li>uses <code>serialize()</code> and <code>attr()</code></li>
<li>uses <code>r</code> instead of <code>response</code>, because it is not the variable name, but <a href="http://stackoverflow.com/questions/3958197/jquery-e-refer-as-event">its argument position that matters</a>. </li>
</ul>
<h2>Plugins</h2>
<div class="highlight"><pre><span></span>$.fn.functionName = function(options){}
</pre></div>


<p>the above declation makes the plugin available to all jQuery objects. <code>options</code> is a javascript object an <code>$.extend()</code> is often used to make the variables to be consistent regardless of the paramters pass in. </p>
<p>An example that uses plugin, <code>$.extend()</code>, namespace, and trigger. :</p>
<div class="highlight"><pre><span></span><span class="o">$</span><span class="p">.</span><span class="nc">fn</span><span class="p">.</span><span class="nc">photofy</span> <span class="o">=</span> <span class="nt">function</span><span class="o">(</span><span class="nt">options</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">this.each(function()</span> <span class="err">{</span>
    <span class="err">var</span> <span class="err">show</span> <span class="err">=</span> <span class="err">function(e)</span> <span class="err">{</span>
      <span class="err">e.preventDefault()</span><span class="p">;</span>
      <span class="err">settings.tour</span>
              <span class="err">.addClass(&#39;is-showing-photofy&#39;)</span>
              <span class="err">.find(&#39;.photos&#39;)</span>
              <span class="err">.find(&#39;</span><span class="n">li</span><span class="p">:</span><span class="nf">gt</span><span class="p">(</span><span class="s1">&#39;+(settings.count-1)+&#39;</span><span class="p">)</span><span class="s1">&#39;)</span>
<span class="s1">              .hide();</span>
<span class="s1">    }</span>
<span class="s1">    var settings = $.extend({</span>
<span class="s1">      count: 3,</span>
<span class="s1">      tour: $(this)</span>
<span class="s1">    }, options);</span>
<span class="s1">    settings.tour.on(&#39;</span><span class="n">click</span><span class="o">.</span><span class="n">photofy</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">see-photos</span><span class="s1">&#39;, show);</span>
<span class="s1">    settings.tour.on(&#39;</span><span class="kc">show</span><span class="o">.</span><span class="n">photofy</span><span class="s1">&#39;, show);</span>
<span class="s1">  });</span>
<span class="s1">}</span>

<span class="s1">$(document).ready(function() {</span>
<span class="s1">  $(&#39;</span><span class="o">.</span><span class="n">tour</span><span class="s1">&#39;).photofy({ count: 1});</span>

<span class="s1">  $(&#39;</span><span class="o">.</span><span class="kc">show</span><span class="o">-</span><span class="n">photos</span><span class="s1">&#39;).on(&#39;</span><span class="n">click</span><span class="s1">&#39;, function(e) {</span>
<span class="s1">    e.preventDefault();</span>
<span class="s1">    $(&#39;</span><span class="o">.</span><span class="n">tour</span><span class="s1">&#39;).trigger(&#39;</span><span class="kc">show</span><span class="o">.</span><span class="n">photofy</span><span class="err">&#39;</span><span class="p">);</span>
  <span class="p">}</span><span class="o">);</span>
<span class="err">}</span><span class="o">);</span>
</pre></div>


<h2>Promises</h2>
<p>Promise is a way to define a ajax and reuse it in different places. It is common to implement it with closure, <a href="https://gist.github.com/814052/690a6b41dc8445479676b347f1ed49f4fd0b1637">but that is not necessary</a>. A promise object is by convention defined with a Capitalized variable and returns the result of a ajax request. The return value is by convention stored in <code>promise</code> variable. $.ajax request could be stored directly 
<code>$.Deferred()</code> is used when the result returned by the ajax callback needs to be changed, or needs different resolution. <code>resovle()</code> -&gt; <code>done()</code> and <code>reject()</code> -&gt; <code>fail()</code>. These resolutions are chained to the promise object making the call.</p>
<div class="highlight"><pre><span></span>var Vacation = {
  getPrice: function(location){
    var promise = $.Deferred();
    $.ajax({
      url: &#39;/vacation/prices&#39;,
      data: {q: location},
      success: function(result){
        promise.resolve(result.price);
      },
      error: function () {
        var error = &#39;invalid location&#39;;
        promise.reject(error);
      }
    });
    return promise;
  }
}

$(document).ready(function() {
  $(&#39;button&#39;).on(&#39;click&#39;, function(){
    var location = $(&#39;.location&#39;).text();
    Vacation.getPrice(location).done(function(result){
      $(&#39;.price&#39;).text(result)
      }).fail(function(result) { 
        console.log(result);
    });
  });
});
</pre></div>


<hr>
<p>When using many different promises, the order in which they are returned may differ. This is a bug due to the concurrency feature of promise.</p>
<div class="highlight"><pre><span></span>$.when(&lt;promise1&gt;, &lt;promise2&gt;...)
.then(function(p1Data, p2Data(){...}))
</pre></div>


<p>are used to fix this problem. The function calls on promise objects are made by <code>$.when()</code> and the results and processing is done by <code>then()</code>.</p>
<div class="highlight"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">tour</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parent</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">location</span> <span class="o">=</span> <span class="nx">tour</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">resultDiv</span> <span class="o">=</span> <span class="nx">tour</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.results&#39;</span><span class="p">).</span><span class="nx">empty</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">Vacation</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">(</span><span class="nx">location</span><span class="p">),</span> <span class="nx">Photo</span><span class="p">.</span><span class="nx">getPhoto</span><span class="p">(</span><span class="nx">location</span><span class="p">)</span>
    <span class="p">).</span><span class="nx">then</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">priceResult</span><span class="p">,</span> <span class="nx">photoResult</span><span class="p">){</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;$&#39;</span><span class="o">+</span><span class="nx">priceResult</span><span class="o">+</span><span class="s1">&#39;&lt;/p&gt;&#39;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">resultDiv</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;img /&gt;&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="nx">photoResult</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">resultDiv</span><span class="p">);</span>
    <span class="p">})</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>


<h2>Helpful Resources</h2>
<ul>
<li><a href="http://api.jquery.com/jQuery.ajax/">jQuery Ajax Documentation</a></li>
<li><a href="http://learn.jquery.com/plugins/advanced-plugin-concepts/">Advanced Plugin Concepts</a></li>
<li><a href="http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/">Understanding JQuery.Deferred and Promise</a></li>
</ul> 
	<a class="btn btn-mini xsmall" href="https://www.4thinker.com/jquery-ajax-notes.html">
          <i class="icon-comment"></i> Comment </a>
	<hr />
      </div>
      
    </div>
    

 
        



    <div class='row-fluid'>
      <div class='article-title span12'> 
        <a href="https://www.4thinker.com/jquery-notes.html"><h1>jQuery Notes</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<div class="article-sidebar">

<span>July 27, 2013 </span>

<span>
[ <a href="https://www.4thinker.com/category/web.html">web</a> ]
</span>

<span>
 
<a href="https://www.4thinker.com/tag/javascript.html">#javascript</a></span>

  <span>Read in 7 min.</span>

    <span id="post-share-links">
        <a href="http://twitter.com/home?status=jQuery%20Notes%20 https%3A//www.4thinker.com/jquery-notes.html" target="_blank" title="Share on Twitter"><i class="icon-large icon-twitter-sign"></i></a> 
        <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=https%3A//www.4thinker.com/jquery-notes.html&p[images][0]=&p[title]=jQuery%20Notes%20&p[summary]=%3Cp%3E%3Ca%20href%3D%22http%3A//mbsy.co/7sh6q%22%3ETry%20jQuery%3C/a%3E%3C/p%3E%0A%3Cp%3E%3Ca%20href%3D%22https%3A//www.youtube.com/watch%3Fv%3D_iRIPJHrdXg%26amp%3Blist%3DPLBB954DF18DA3F2A5%22%3EjQuery%20Video%20Tutorial%3C/a%3E%20by%20Derek%20Banas%20%40%20%3Ca%20href%3D%22newthinktank.com%22%3Enewthinktank.com%3C/a%3E%3C/p%3E%0A%3Ch2%3EThe%20Basic%3C/h2%3E%0A%3Cp%3EGet%20the%20latest%20jQuery%20downloaded%3A%3C/p%3E%0A%3Cdiv%20class%3D%22highlight%22%3E%3Cpre%3E%3Cspan%3E%3C/span%3E%3Cspan%20class%3D%22nt%22%3E%26lt%3Bscript%3C/span%3E%20%3Cspan%20class%3D%22na%22%3Etype%3D%3C/span%3E%3Cspan%20class%3D%22s%22%3E%26quot%3Btext/javascript%26quot%3B%3C/span%3E%20%3Cspan%20class%3D%22na%22%3Esrc%3D%3C/span%3E%3Cspan%20class%3D%22s%22%3E%26quot%3Bhttp%3A//code.jquery.com/jquery-latest.js%26quot%3B%3C/span%3E%3Cspan%20class%3D%22nt%22%3E%26gt%3B%26lt%3B/script%26gt%3B%3C/span%3E%0A%3C/pre%3E%3C/div%3E%0A%0A%0A%3Cp%3EOr%20Google%27s%20version%20for%20faster%20download%20speed%3A%3C/p%3E%0A%3Cdiv%20class%3D%22highlight%22%3E%3Cpre%3E%3Cspan%3E%3C/span%3E%26lt%3Bscript%20src%3D%26quot%3Bhttp%3A//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js%26quot%3B%26gt%3B%0A%3C/pre%3E%3C/div%3E%0A%0A%0A%3Cp%3EjQuery%20manipulates%20the%20DOM%2C%20tree-like%20representation%20of%20HTML%20file.%20It%20also%20handles%20the%20difference%20of%20JavaScript%20engine%20in%20different%20browsers.%0AThe%20following%20code%20waits%20for%20the%20document%20to%20finish%20loading%2C%20this%20is%20often%20always%20used%20for%20jQuery%3A%3C/p%3E%0A%3Cdiv%20class%3D%22highlight%22%3E%3Cpre%3E%3Cspan%3E%3C/span%3EjQuery%28document%29.ready%28function%28%29%7B%0A%20%20%20%20%26lt%3Bcode%26gt%3B%0A%7D%29%3B%0A%3C/pre%3E%3C/div%3E%0A%0A%0A%3Cp%3EjQuery%20objects%20are%20created%20by%20surrounding%20the%20%E2%80%A6%3C/p%3E" target="_blank" title="Share on Facebook"><i class="icon-large icon-facebook-sign"></i></a> 
        <a href="https://plus.google.com/share?url=https%3A//www.4thinker.com/jquery-notes.html" target="_blank" title="Share on Google Plus"><i class="icon-large icon-google-plus-sign"></i></a> 
        <!--<a href="" target="_blank" title="Share on Linkedin"><i class="icon-large icon-linkedin-alt"></i></a>-->
        <a href="mailto:?subject=jQuery%20Notes%20&body=https%3A//www.4thinker.com/jquery-notes.html" target="_blank" title="Share via Email"><i class="icon-large icon-envelope-sign"></i></a>
    </span>

</div>      </div>
      <div class="summary span10">
	<p><a href="http://mbsy.co/7sh6q">Try jQuery</a></p>
<p><a href="https://www.youtube.com/watch?v=_iRIPJHrdXg&amp;list=PLBB954DF18DA3F2A5">jQuery Video Tutorial</a> by Derek Banas @ <a href="newthinktank.com">newthinktank.com</a></p>
<h2>The Basic</h2>
<p>Get the latest jQuery downloaded:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;http://code.jquery.com/jquery-latest.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>


<p>Or Google's version for faster download speed:</p>
<div class="highlight"><pre><span></span>&lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js&quot;&gt;
</pre></div>


<p>jQuery manipulates the DOM, tree-like representation of HTML file. It also handles the difference of JavaScript engine in different browsers.
The following code waits for the document to finish loading, this is often always used for jQuery:</p>
<div class="highlight"><pre><span></span>jQuery(document).ready(function(){
    &lt;code&gt;
});
</pre></div>


<p>jQuery objects are created by surrounding the â€¦</p> 
	<a class="btn btn-mini xsmall" href="https://www.4thinker.com/jquery-notes.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      
<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="https://www.4thinker.com/tag/javascript.html">1</a></li>

    <li class="next disabled"><a href="#">&rarr; Next</a></li>

</ul>
</div>
 
  
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
	<div class="social span4" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    <li><a href="http://stackoverflow.com/users/986067/forethinker"><i class="icon-Stackoverflow" style="color: #1f334b"></i>Stackoverflow</a></li>
	    <li><a href="http://github.com/forethinker"><i class="icon-Github" style="color: #1f334b"></i>Github</a></li>
            <li>
            <a href="mailto:help4thinker@gmail.com"><i class="icon-envelope" style="color: #1f334b" ></i> E-mail</a>
            </li>
            <li>
            <a href="http://www.4thinker.com/pages/aboutme.html"><i class="icon-thumbs-up" style="color: #1f334b" ></i> Me</a>
            </li>
            <li>
            <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
              <input type="hidden" name="cmd" value="_s-xclick">
              <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
              ">
              <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
              <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
            </form>
            </li>

	  </ul>
	</div>
        <div class="links span4" align="center">
          <ul class="nav nav-list">
            <li class="nav-header"> 
              Links
            </li>
            
            <li><a href="http://mbsy.co/7sh6q">Codeschool </a></li>
            <li><a href="http://coursera.org/">Cousera </a></li>
            <li><a href="http://howtogeek.com/">How to Geek</a></li>
            <li><a href="http://lifehacker.com/">Lifehacker</a></li>
            <li><a href="http://thegeekstuff.com/">The Geek Stuff</a></li>
            <li><a href="http://vimcasts.org/">Vim Casts</a></li>
          </ul>
        </div>
	<div class="site-nav span4" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href="https://www.4thinker.com"><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="https://www.4thinker.com/archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="https://www.4thinker.com/tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	    <li> <a href="https://www.4thinker.com/feeds/all.rss.xml" rel="alternate">
                <i class="icon-rss" style="color: #1f334b"></i>
                RSS Feed</a></li>
            <li><a href="https://www.4thinker.com/feeds/all.atom.xml" rel="alternate">
                <i class="icon-rss-sign" style="color: #1f334b"></i>
                Atom Feed</a></li>
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p style="text-align: center; margin: 0.1em;"><a href="https://www.4thinker.com">Forethinker</a>
    &copy; <a href="pages/aboutme.html">forethinker</a>

    <div class="pull-right" style="font-size: 8px">
    Powered by <a href="http://github.com/getpelican/pelican">Pelican</a> and
    <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a> with <a href="https://github.com/theanalyst/built-texts">built-texts theme</a>. 
    </div>
  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"> </script>

<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0-wip/js/bootstrap.min.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-53043426-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>

</body>
</html>